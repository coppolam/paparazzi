<!DOCTYPE flight_plan SYSTEM "../flight_plan.dtd">

<flight_plan alt="1.5" ground_alt="0" lat0="51.990634" lon0="4.376789"
	max_dist_from_home="8" name="Flight Plan Leader follower" security_height="0.4">
	<header>
		#include "autopilot.h"
		#include "subsystems/ahrs.h"
		#include "subsystems/electrical.h"
		#include "subsystems/datalink/datalink.h"
	</header>
	<waypoints>
		<waypoint height="0" name="HOME" x="0.0" y="0.0" />
		<waypoint name="CIRCLEWP" x="0.0" y="0.0"/>
		<waypoint height="2" name="CLIMB" x="1.2" y="-0.6" />
		<waypoint height="1.5" name="STDBY" x="0.5" y="0.5" />
		<waypoint name="HOVER" x="1.0" y="1.0"/>
		<waypoint name="TD" x="0.8" y="-1.7" />
		<!-- waypoint name="t0" lat="51.9906258" lon="4.3767972"/>
		<waypoint name="t1" lat="51.9906370" lon="4.3768014"/>
		<waypoint name="t2" lat="51.9906412" lon="4.3767794"/>
		<waypoint name="t3" lat="51.9906294" lon="4.3767780"/-->
		<waypoint name="t0" x="0.9" y="0.0"/>
		<waypoint name="t1" x="0.0" y="0.9"/>
		<waypoint name="t2" x="-0.9" y="0.0"/>
		<waypoint name="t3" x="0.0" y="-0.9"/>
		<waypoint lat="51.9906213" lon="4.3768628" name="_CZ1" />
		<waypoint lat="51.9905874" lon="4.3767766" name="_CZ2" />
		<waypoint lat="51.9906409" lon="4.3767226" name="_CZ3" />
		<waypoint lat="51.990667" lon="4.376806" name="_CZ4" />
		<waypoint lat="51.9906831" lon="4.3768073" name="_DZ1" />
		<waypoint lat="51.9906472" lon="4.3767093" name="_DZ2" />
		<waypoint lat="51.9905876" lon="4.3767679" name="_DZ3" />
		<waypoint lat="51.9906254" lon="4.3768677" name="_DZ4" />
	</waypoints>
	<sectors>
		<!-- sector color="red" name="CyberZoo">
			<corner name="_CZ1" />
			<corner name="_CZ2" />
			<corner name="_CZ3" />
			<corner name="_CZ4" />
		</sector-->
		<sector color="orange" name="DangerZone">
			<corner name="_DZ1" />
			<corner name="_DZ2" />
			<corner name="_DZ3" />
			<corner name="_DZ4" />
		</sector>
	</sectors>
	<variables>
		<variable var="selfradius" min="-6" max="6" step="0.1" init="-1.0" />
		<variable var="selfheading" min="0" max="360" step="10" init="0.0"/>
	</variables>
	<exceptions>
		<!--exception cond="!InsideDangerZone(GetPosX(), GetPosY())" deroute="Standby" /-->
		<!--exception cond="datalink_time > 2" deroute="land here" /-->
		<!-- exception cond="electrical.bat_low && !(nav_block == IndexOfBlock('land')) && !(nav_block == IndexOfBlock('flare')) && !(nav_block == IndexOfBlock('landed'))"	deroute="land" />
		<exception cond="electrical.bat_critical && !(nav_block == IndexOfBlock('land')) && !(nav_block == IndexOfBlock('flare')) && !(nav_block == IndexOfBlock('landed'))" deroute="land here" /-->
	</exceptions>
	<blocks>
		<block name="Wait GPS">
			<call_once fun="NavKillThrottle()" />
			<while cond="!GpsFixValid()" />
		</block>
		<block name="Geo init">
			<while cond="LessThan(NavBlockTime(), 5)" />
			<call_once fun="NavSetAltitudeReferenceHere()" />
			<!-- call_once fun="NavSetGroundReferenceHere()"/-->
		</block>
		<block name="Holding point">
			<call_once fun="NavKillThrottle()" />
			<attitude pitch="0" roll="0" throttle="0"
				vmode="throttle" />
		</block>
		<block name="Follow_leader">
			<while cond="TRUE">
				<call_once fun="ndi_follow_leader()"/>
			</while>
		</block>
	</blocks>
</flight_plan>
